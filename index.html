<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>STEPS - Scalable Training Estimation and Planning System</title>
  <link rel="stylesheet" href="styles.css"/>
  <!-- Font Awesome Icons -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
        integrity="sha512-papNMzNnQn5h+1G+FHu8SyuXHs6A1k+Ln7tK5qRo1l5eYm6Jzv+1pArJ7N4C9FfpRrmAgM3tYWd3FZ9jKz1Bw=="
        crossorigin="anonymous" referrerpolicy="no-referrer"/>
  <!-- Chart.js -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <!-- jsPDF -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <!-- Leaflet CSS and JS -->
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
    integrity="sha512-sA+8s4M6Omi0oJmd5dbuap3T7jsSObbd3xd4/fP8HAmVRHNFht6BFB/hxPx9U0z0XnPFADLvF6Roig4SGuOj/A=="
    crossorigin=""/>
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
    integrity="sha512-VV1c7L1lEpByI4A+ZOC88SH0s+hRxbgAjvzuz36eZGwN+I9IMRhMC/jazcK0e+RghWyA4EkO8wgm+0d0JY3h3g=="
    crossorigin=""></script>
</head>
<body>
<div class="container">
  <header>
    <h1>STEPS Decision Aid Tool</h1>
    <p>
      STEPS helps policy makers in India plan and scale Field Epidemiology Training Programs by forecasting programme uptake,
      evaluating economic tradeoffs, and comparing key programme features.
    </p>
  </header>

  <nav class="tabs" role="tablist">
    <button class="tablink" data-tab="introTab" aria-selected="true">
      <i class="fa-solid fa-info-circle"></i><span> Introduction</span>
    </button>
    <button class="tablink" data-tab="instructionsTab" aria-selected="false">
      <i class="fa-solid fa-circle-question"></i><span> Instructions</span>
    </button>
    <button class="tablink" data-tab="attributesTab" aria-selected="false">
      <i class="fa-solid fa-list"></i><span> Attributes</span>
    </button>
    <button class="tablink" data-tab="inputsTab" aria-selected="false">
      <i class="fa-solid fa-sliders"></i><span> Inputs</span>
    </button>
    <button class="tablink" data-tab="probTab" aria-selected="false">
      <i class="fa-solid fa-chart-pie"></i><span> Adoption Likelihood</span>
    </button>
    <button class="tablink" data-tab="costsTab" aria-selected="false">
      <i class="fa-solid fa-calculator"></i><span> Costs &amp; Benefits</span>
    </button>
    <button class="tablink" data-tab="visualizationsTab" aria-selected="false">
      <i class="fa-solid fa-map"></i><span> Visualizations</span>
    </button>
    <button class="tablink" data-tab="scenariosTab" aria-selected="false">
      <i class="fa-solid fa-folder-open"></i><span> Saved Scenarios</span>
    </button>
  </nav>

  <!-- Introduction Tab -->
  <section id="introTab" class="tabcontent" tabindex="0" style="display: block;">
    <div class="intro-box">
      <p>
        Field Epidemiology Training Programs (FETP) are essential to strengthening public health responses.
        STEPS uses discrete choice experiment estimates to forecast programme uptake ‚Äì meaning the predicted likelihood
        that decision makers will endorse a given training configuration ‚Äì and to assess cost‚Äìbenefit tradeoffs.
      </p>
      <ul>
        <li><strong>Instructions</strong> ‚Äì A visually engaging guide to using the tool.</li>
        <li><strong>Attributes</strong> ‚Äì An overview of key features with tooltips.</li>
        <li><strong>Inputs</strong> ‚Äì Configure options using interactive controls.</li>
        <li><strong>Adoption Likelihood</strong> ‚Äì See forecasted decision maker support.</li>
        <li><strong>Costs &amp; Benefits</strong> ‚Äì Explore a dynamic economic summary with toggles.</li>
        <li><strong>Visualizations</strong> ‚Äì Interact with maps and dashboards showing capacities & cost distributions.</li>
        <li><strong>Saved Scenarios</strong> ‚Äì Save, compare, and export configurations.</li>
      </ul>
    </div>
  </section>

  <!-- Instructions Tab -->
  <section id="instructionsTab" class="tabcontent" tabindex="0">
    <div class="calculation-info instructions">
      <h4>How to Use STEPS</h4>
      <ol>
        <li><strong>Review Attributes:</strong> See ‚ÄúAttributes‚Äù for a quick breakdown of each feature (with hover emojis).</li>
        <li><strong>Configure Inputs:</strong> In ‚ÄúInputs,‚Äù select your choices in the recommended order. Keep an eye on the ‚ÄúEstimated Cost‚Äù display.</li>
        <li><strong>Adoption Likelihood:</strong> Check the donut chart for predicted endorsement levels.</li>
        <li><strong>Costs &amp; Benefits:</strong> Check the dynamic cost‚Äìbenefit summary, and use the toggles for detailed breakdowns.</li>
        <li><strong>Visualizations:</strong> Interact with the live map (Leaflet) and sample dashboard chart (Chart.js) for a quick capacity overview.</li>
        <li><strong>Saved Scenarios:</strong> Save your configurations and export them to PDF for side-by-side comparisons.</li>
      </ol>
    </div>
  </section>

  <!-- Attributes Tab -->
  <section id="attributesTab" class="tabcontent" tabindex="0">
    <h2>Key Attributes</h2>
    <div class="attributes-grid">
      <!-- 1) Level of Training -->
      <div class="attribute-card">
        <div class="attribute-icon">
          <i class="fa-solid fa-user-graduate"></i>
          <i class="fa-solid fa-circle-info info-icon" data-tooltip="Frontlineüìä, Intermediateüìà, AdvancedüöÄ ‚Äî each tier focuses on deeper epidemiological skills."></i>
        </div>
        <div class="attribute-content">
          <h4>Level of Training</h4>
          <p>Frontline, Intermediate, Advanced.</p>
        </div>
      </div>

      <!-- 2) Training Model -->
      <div class="attribute-card">
        <div class="attribute-icon">
          <i class="fa-solid fa-user-tie"></i>
          <i class="fa-solid fa-circle-info info-icon" data-tooltip="In-serviceüßë‚Äçüíª if participants work while training; Scholarship-basedüéì for full-time study."></i>
        </div>
        <div class="attribute-content">
          <h4>Training Model</h4>
          <p>In-service or Scholarship-based.</p>
        </div>
      </div>

      <!-- 3) Delivery Method -->
      <div class="attribute-card">
        <div class="attribute-icon">
          <i class="fa-solid fa-chalkboard"></i>
          <i class="fa-solid fa-circle-info info-icon" data-tooltip="In-personüè´, Hybridüíªüè´, or Fully Onlineüíª. Choose how training is delivered."></i>
        </div>
        <div class="attribute-content">
          <h4>Delivery Method</h4>
          <p>In-person, Hybrid, or Fully Online.</p>
        </div>
      </div>

      <!-- 4) Number of Training Sites -->
      <div class="attribute-card">
        <div class="attribute-icon">
          <i class="fa-solid fa-map-location-dot"></i>
          <i class="fa-solid fa-circle-info info-icon" data-tooltip="Single Central Siteüìç, Multiple State Capitalsüìçüìç, Zonal Centersüìçüìçüìç, or Decentralized Sitesüìçüìçüìçüìç."></i>
        </div>
        <div class="attribute-content">
          <h4>Number of Training Sites</h4>
          <p>Single Central, State Capitals, Zonal, or Decentralized.</p>
        </div>
      </div>

      <!-- 5) Annual Training Capacity -->
      <div class="attribute-card">
        <div class="attribute-icon">
          <i class="fa-solid fa-people-group"></i>
          <i class="fa-solid fa-circle-info info-icon" data-tooltip="100, 500, 1000, 1500, or 2000. More participants = faster scale-up."></i>
        </div>
        <div class="attribute-content">
          <h4>Annual Training Capacity</h4>
          <p>100 to 2000 participants.</p>
        </div>
      </div>

      <!-- 6) Stipend Amount -->
      <div class="attribute-card">
        <div class="attribute-icon">
          <i class="fa-solid fa-hand-holding-dollar"></i>
          <i class="fa-solid fa-circle-info info-icon" data-tooltip="$200, $400, $600, or $800. Offsets living costs."></i>
        </div>
        <div class="attribute-content">
          <h4>Stipend Amount</h4>
          <p>$200‚Äì$800 support.</p>
        </div>
      </div>

      <!-- 7) Fee per Training Completion -->
      <div class="attribute-card">
        <div class="attribute-icon">
          <i class="fa-solid fa-file-invoice-dollar"></i>
          <i class="fa-solid fa-circle-info info-icon" data-tooltip="A completion fee upon finishing training. Adjustable via slider."></i>
        </div>
        <div class="attribute-content">
          <h4>Fee per Completion</h4>
          <p>Adjustable (USD).</p>
        </div>
      </div>
    </div>
  </section>

  <!-- Inputs Tab -->
  <section id="inputsTab" class="tabcontent" tabindex="0">
    <div class="input-card">
      <h2>Configure Programme Options <i class="fa-solid fa-circle-info info-icon-input" data-tooltip="Hover each label icon for details."></i></h2>
      <p>
        Select your options in the recommended order (Level‚ÜíModel‚ÜíDelivery‚ÜíSites‚ÜíCapacity‚ÜíStipend‚ÜíFee). 
        Keep an eye on the dynamic ‚ÄúEstimated Cost‚Äù below.
      </p>
      <form onsubmit="event.preventDefault();">
        <div class="input-cards">
          <!-- 1) Level of Training -->
          <div class="input-level-card">
            <h3>
              Level of Training<span class="reference">(Ref: Frontline)</span>
              <i class="fa-solid fa-user-graduate info-icon-input" 
                 data-tooltip="Frontlineüìä (3 mo), Intermediateüìà (12 mo), AdvancedüöÄ (24 mo)."></i>
            </h3>
            <div class="options">
              <label><input type="radio" name="levelTraining" value="frontline" checked /> Frontlineüìä (3 mo)</label>
              <label><input type="radio" name="levelTraining" value="intermediate" /> Intermediateüìà (12 mo)</label>
              <label><input type="radio" name="levelTraining" value="advanced" /> AdvancedüöÄ (24 mo)</label>
            </div>
          </div>

          <!-- 2) Training Model -->
          <div class="input-level-card">
            <h3>
              Training Model<span class="reference">(Ref: In-service)</span>
              <i class="fa-solid fa-user-tie info-icon-input" 
                 data-tooltip="In-serviceüßë‚Äçüíª or Scholarship-basedüéì."></i>
            </h3>
            <div class="options">
              <label><input type="radio" name="trainingModel" value="inservice" checked /> In-serviceüßë‚Äçüíª</label>
              <label><input type="radio" name="trainingModel" value="scholarship" /> Scholarship-basedüéì</label>
            </div>
          </div>

          <!-- 3) Delivery Method -->
          <div class="input-level-card">
            <h3>
              Delivery Method<span class="reference">(Ref: Online)</span>
              <i class="fa-solid fa-laptop info-icon-input" 
                 data-tooltip="In-personüè´, Hybridüíªüè´, or Onlineüíª."></i>
            </h3>
            <div class="options">
              <label><input type="radio" name="deliveryMethod" value="inperson" /> In-personüè´</label>
              <label><input type="radio" name="deliveryMethod" value="hybrid" /> Hybridüíªüè´</label>
              <label><input type="radio" name="deliveryMethod" value="online" checked /> Fully Onlineüíª</label>
            </div>
          </div>

          <!-- 4) Number of Training Sites -->
          <div class="input-level-card">
            <h3>
              Number of Training Sites<span class="reference">(Ref: Multiple State Capitals)</span>
              <i class="fa-solid fa-map-location-dot info-icon-input" 
                 data-tooltip="Singleüìç, State Capitalsüìçüìç, Zonalüìçüìçüìç, Decentralizedüìçüìçüìçüìç."></i>
            </h3>
            <div class="options">
              <label><input type="radio" name="trainingSites" value="centralized" /> Single Central Siteüìç</label>
              <label><input type="radio" name="trainingSites" value="stateCapitals" checked /> Multiple State Capitalsüìçüìç</label>
              <label><input type="radio" name="trainingSites" value="zonalCenters" /> Zonal Regional Centersüìçüìçüìç</label>
              <label><input type="radio" name="trainingSites" value="decentralized" /> Decentralized Local Sitesüìçüìçüìçüìç</label>
            </div>
          </div>

          <!-- 5) Annual Training Capacity -->
          <div class="input-level-card">
            <h3>
              Annual Training Capacity<span class="reference">(Ref: 500 trainees)</span>
              <i class="fa-solid fa-people-group info-icon-input" 
                 data-tooltip="100, 500, 1000, 1500, or 2000. Larger = faster scale-up."></i>
            </h3>
            <div class="options">
              <label><input type="radio" name="annualCapacity" value="100" /> 100 participants</label>
              <label><input type="radio" name="annualCapacity" value="500" checked /> 500 participants</label>
              <label><input type="radio" name="annualCapacity" value="1000" /> 1000 participants</label>
              <label><input type="radio" name="annualCapacity" value="1500" /> 1500 participants</label>
              <label><input type="radio" name="annualCapacity" value="2000" /> 2000 participants</label>
            </div>
          </div>

          <!-- 6) Stipend Amount -->
          <div class="input-level-card">
            <h3>
              Stipend Amount<span class="reference">(Ref: $200)</span>
              <i class="fa-solid fa-hand-holding-dollar info-icon-input" 
                 data-tooltip="$200‚Äì$800 to offset living costs."></i>
            </h3>
            <div class="options">
              <label><input type="radio" name="stipendAmount" value="200" checked /> $200</label>
              <label><input type="radio" name="stipendAmount" value="400" /> $400</label>
              <label><input type="radio" name="stipendAmount" value="600" /> $600</label>
              <label><input type="radio" name="stipendAmount" value="800" /> $800</label>
            </div>
          </div>

          <!-- 7) Fee per Training Completion -->
          <div class="input-level-card">
            <h3>
              Fee per Training Completion (USD)
              <i class="fa-solid fa-money-bill-wave info-icon-input" 
                 data-tooltip="Slider for final fee after training."></i>
            </h3>
            <div class="options slider-option">
              <label for="costSliderFETP">
                <i class="fa-solid fa-dollar-sign"></i>
                <span id="costLabelFETP">2500</span>
              </label>
              <input type="range" id="costSliderFETP" min="500" max="5000" step="100" value="2500"
                     oninput="updateFETPCostDisplay(this.value); updateEstimatedCost();" />
            </div>
          </div>
        </div>

        <!-- Dynamic Estimated Cost Display -->
        <div class="calculation-info" id="dynamicCostEstimate" style="margin-top:15px;">
          <h4>Estimated Cost</h4>
          <p id="estimatedCostDisplay">Select all inputs to estimate total training cost.</p>
        </div>

        <div class="buttons-row">
          <button type="button" onclick="openFETPScenario()">Calculate &amp; View Results</button>
        </div>
      </form>
    </div>
  </section>

  <!-- Popup Modal for Results -->
  <div id="resultModal" class="modal">
    <div class="modal-content">
      <span class="close-button" onclick="closeModal()">&times;</span>
      <div id="modalResults"></div>
    </div>
  </div>

  <!-- Adoption Likelihood Tab -->
  <section id="probTab" class="tabcontent" tabindex="0">
    <div class="calculation-info">
      <h4>Adoption Likelihood</h4>
      <p>Click ‚ÄúShow Probability Plot‚Äù to view the forecasted decision maker support.</p>
      <div class="buttons-row">
        <button onclick="renderFETPProbChart()">Show Probability Plot</button>
      </div>
      <div class="chart-grid">
        <div class="chart-box" style="height:350px; overflow:hidden;">
          <h3>Adoption Likelihood</h3>
          <canvas id="probChartFETP"></canvas>
        </div>
      </div>
    </div>
  </section>

  <!-- Costs & Benefits Tab -->
  <section id="costsTab" class="tabcontent" tabindex="0">
    <div class="calculation-info">
      <h4>Costs &amp; Benefits Analysis</h4>
      <p>
        This section estimates the total programme cost and monetised benefits.<br />
        <small>
          Benefits = (QALY Gain per Participant √ó Number of Trainees √ó $50,000).
          This approximates the economic value of improved health outcomes.
        </small>
      </p>
      <div class="qaly-selector">
        <label for="qalyFETPSelect">Select QALY Gain per Participant:</label>
        <select id="qalyFETPSelect" onchange="renderFETPCostsBenefits()">
          <option value="low">Low (0.01 QALYs)</option>
          <option value="moderate" selected>Moderate (0.05 QALYs)</option>
          <option value="high">High (0.08 QALYs)</option>
        </select>
      </div>
      <div id="costsFETPResults"></div>
      <div class="modelling-assumptions">
        <h3><i class="fa-solid fa-lightbulb"></i> Assumptions</h3>
        <p>
          Cost estimates combine variable costs (participant fee) and fixed costs (venue, materials, trainer fees, etc.).<br>
          A base fixed cost of $35,500 is adjusted by $10 for each trainee above or below 500.
        </p>
      </div>
      <div class="cost-icons">
        <button class="buttons-row" onclick="toggleCostAccordion()">Cost Breakdown</button>
        <button class="buttons-row" onclick="toggleFETPBenefitsAnalysis()">Benefits Explanation</button>
      </div>
      <div id="detailedCostBreakdown" style="display:none;">
        <div class="accordion-item">
          <h3>Direct Costs</h3>
          <div class="accordion-content">
            <ul>
              <li><strong>Training &amp; Development:</strong>
                <ul>
                  <li>Venue rental for workshops & meetings</li>
                  <li>Acquisition of training materials</li>
                  <li>Compensation for trainers & speakers</li>
                  <li>Content dev & licensing fees</li>
                </ul>
              </li>
              <li><strong>Personnel Costs:</strong>
                <ul>
                  <li>Salaries for full-time staff</li>
                  <li>Consultant fees</li>
                  <li>Employment benefits & taxes</li>
                </ul>
              </li>
              <li><strong>Technology Costs:</strong>
                <ul>
                  <li>Hardware procurement</li>
                  <li>Software purchases</li>
                  <li>Maintenance & support</li>
                </ul>
              </li>
              <li><strong>Logistical Costs:</strong>
                <ul>
                  <li>Travel & accommodation expenses</li>
                  <li>Catering services</li>
                </ul>
              </li>
              <li><strong>Miscellaneous Costs:</strong>
                <ul>
                  <li>Printing & stationery</li>
                  <li>Communication expenses</li>
                  <li>Insurance coverage</li>
                </ul>
              </li>
            </ul>
          </div>
        </div>
        <div class="accordion-item">
          <h3>Indirect Costs</h3>
          <div class="accordion-content">
            <ul>
              <li><strong>Opportunity Costs:</strong>
                <ul>
                  <li>Lost productivity from training participation</li>
                  <li>Hiring temps or paying overtime</li>
                </ul>
              </li>
              <li><strong>Infrastructure Costs:</strong>
                <ul>
                  <li>Facility upgrades & modifications</li>
                  <li>Depreciation of used equipment</li>
                </ul>
              </li>
              <li><strong>Administrative Costs:</strong>
                <ul>
                  <li>Office space & utilities</li>
                  <li>Management & oversight time</li>
                </ul>
              </li>
            </ul>
          </div>
        </div>
        <div class="accordion-item">
          <h3>Recurring Costs</h3>
          <div class="accordion-content">
            <ul>
              <li><strong>Maintenance & Upkeep:</strong>
                <ul>
                  <li>Regular updates to training materials</li>
                  <li>Continuous trainer development</li>
                  <li>Renewal fees for software/licenses</li>
                </ul>
              </li>
            </ul>
          </div>
        </div>
      </div>
      <div id="detailedFETPBenefitsAnalysis" class="cost-cards" style="display:none;">
        <div class="cost-card">
          <h4><i class="fa-solid fa-hand-holding-dollar"></i> QALY Benefits</h4>
          <p>
            Benefits = (QALY Gain per Participant √ó Number of Trainees √ó $50,000).
            This reflects the economic value of improved health outcomes.
          </p>
        </div>
      </div>
    </div>
  </section>

  <!-- Visualizations Tab -->
  <section id="visualizationsTab" class="tabcontent" tabindex="0">
    <h2>Interactive Visualizations</h2>
    <div class="visualizations-container">
      <!-- Leaflet Map Container -->
      <div id="mapContainer" class="map-container">
        <p style="font-size:0.9em;color:#555;">
          Explore the sample map below with hypothetical training site markers. Zoom and pan to see more.
        </p>
      </div>
      <!-- Dashboard Container -->
      <div id="dashboardContainer" class="dashboard-container">
        <div style="text-align:center; margin-bottom:10px; color:#444;">
          <strong>Sample Distribution Chart</strong><br />
          <small>These data are illustrative only.</small>
        </div>
        <canvas id="dashboardChart"></canvas>
      </div>
    </div>
  </section>

  <!-- Scenarios Tab -->
  <section id="scenariosTab" class="tabcontent" tabindex="0">
    <div class="calculation-info">
      <h4>Saved Scenarios</h4>
      <p>
        Each scenario includes your chosen options plus the computed uptake and net benefit.
        Export saved scenarios to PDF for side-by-side comparison.
      </p>
      <div class="buttons-row">
        <button onclick="saveFETPScenario()">Save Current Scenario</button>
        <button onclick="exportFETPComparison()">Compare &amp; Export PDF</button>
      </div>
      <div class="table-container">
        <table id="FETPScenarioTable">
          <thead>
            <tr>
              <th>Name</th>
              <th>Fee (USD)</th>
              <th>Level</th>
              <th>Model</th>
              <th>Stipend</th>
              <th>Capacity</th>
              <th>Delivery</th>
              <th>Sites</th>
              <th>Uptake (%)</th>
              <th>Net Benefit (USD)</th>
            </tr>
          </thead>
          <tbody></tbody>
        </table>
      </div>
    </div>
  </section>

  <footer>
    <p>&copy; 2025 STEPS Decision Aid. All Rights Reserved.<br/>Mesfin Genie, Newcastle Business School, The University of Newcastle, Australia</p>
  </footer>
</div>
<script src="script.js"></script>
</body>
</html>
