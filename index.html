<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>STEPS - Scalable Training Estimation and Planning System</title>
  <link rel="stylesheet" href="styles.css" />
  <!-- Font Awesome Icons -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
        integrity="sha512-papNMzNnQn5h+1G+FHu8SyuXHs6A1k+Ln7tK5qRo1l5eYm6Jzv+1pArJ7N4C9FfpRrmAgM3tYWd3FZ9jKz1Bw=="
        crossorigin="anonymous" referrerpolicy="no-referrer" />
  <!-- Chart.js -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <!-- jsPDF -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <!-- Leaflet CSS and JS -->
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
    integrity="sha512-sA+8s4M6Omi0oJmd5dbuap3T7jsSObbd3xd4/fP8HAmVRHNFht6BFB/hxPx9U0z0XnPFADLvF6Roig4SGuOj/A=="
    crossorigin=""/>
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
    integrity="sha512-VV1c7L1lEpByI4A+ZOC88SH0s+hRxbgAjvzuz36eZGwN+I9IMRhMC/jazcK0e+RghWyA4EkO8wgm+0d0JY3h3g=="
    crossorigin=""></script>
</head>
<body>
<div class="container">
  <header>
    <h1>STEPS Decision Aid Tool</h1>
    <p>
      STEPS helps policy makers in India plan and scale Field Epidemiology Training Programs by forecasting programme uptake,
      evaluating economic tradeoffs, and comparing key programme features.
    </p>
  </header>

  <nav class="tabs" role="tablist">
    <button class="tablink" data-tab="introTab" aria-selected="true">
      <i class="fa-solid fa-info-circle"></i><span> Introduction</span>
    </button>
    <button class="tablink" data-tab="instructionsTab" aria-selected="false">
      <i class="fa-solid fa-circle-question"></i><span> Instructions</span>
    </button>
    <button class="tablink" data-tab="attributesTab" aria-selected="false">
      <i class="fa-solid fa-list"></i><span> Attributes</span>
    </button>
    <button class="tablink" data-tab="inputsTab" aria-selected="false">
      <i class="fa-solid fa-sliders"></i><span> Inputs</span>
    </button>
    <button class="tablink" data-tab="probTab" aria-selected="false">
      <i class="fa-solid fa-chart-pie"></i><span> Adoption Likelihood</span>
    </button>
    <button class="tablink" data-tab="costsTab" aria-selected="false">
      <i class="fa-solid fa-calculator"></i><span> Costs &amp; Benefits</span>
    </button>
    <button class="tablink" data-tab="visualizationsTab" aria-selected="false">
      <i class="fa-solid fa-map"></i><span> Visualizations</span>
    </button>
    <button class="tablink" data-tab="scenariosTab" aria-selected="false">
      <i class="fa-solid fa-folder-open"></i><span> Saved Scenarios</span>
    </button>
  </nav>

  <!-- Introduction Tab -->
  <section id="introTab" class="tabcontent" tabindex="0" style="display: block;">
    <div class="intro-box">
      <p>
        Field Epidemiology Training Programs (FETP) are essential to strengthening public health responses.
        STEPS uses discrete choice experiment estimates to forecast programme uptake – meaning the predicted likelihood
        that decision makers will endorse a given training configuration – and to assess cost–benefit tradeoffs.
      </p>
      <ul>
        <li><strong>Instructions</strong> – A visually engaging guide to using the tool.</li>
        <li><strong>Attributes</strong> – An overview of key features with tooltips.</li>
        <li><strong>Inputs</strong> – Configure options using interactive controls.</li>
        <li><strong>Adoption Likelihood</strong> – See forecasted decision maker support.</li>
        <li><strong>Costs &amp; Benefits</strong> – Explore a dynamic economic summary with toggles.</li>
        <li><strong>Visualizations</strong> – Interact with maps and dashboards showing capacities & cost distributions.</li>
        <li><strong>Saved Scenarios</strong> – Save, compare, and export configurations.</li>
      </ul>
    </div>
  </section>

  <!-- Instructions Tab -->
  <section id="instructionsTab" class="tabcontent" tabindex="0">
    <div class="calculation-info instructions">
      <h4>How to Use STEPS</h4>
      <ol>
        <li><strong>Review Attributes:</strong> Click the "Attributes" tab to view each key feature with quick tooltips.</li>
        <li><strong>Configure Inputs:</strong> In the "Inputs" tab, specify your choices (Level, Stipend, etc.). Reference values (in parentheses) guide your selection.</li>
        <li><strong>Adoption Likelihood:</strong> Check forecasted decision maker support in the "Adoption Likelihood" tab.</li>
        <li><strong>Costs &amp; Benefits:</strong> Get a comprehensive cost–benefit summary. Click "Cost Breakdown" or "Benefits Explanation" for details.</li>
        <li><strong>Visualizations:</strong> Explore the map with sample training site markers and a sample dashboard chart.</li>
        <li><strong>Saved Scenarios:</strong> Save your configurations and export them to PDF for side-by-side comparison.</li>
      </ol>
    </div>
  </section>

  <!-- Attributes Tab -->
  <section id="attributesTab" class="tabcontent" tabindex="0">
    <h2>Key Attributes</h2>
    <div class="attributes-grid">
      <div class="attribute-card">
        <div class="attribute-icon">
          <i class="fa-solid fa-user-graduate"></i>
          <i class="fa-solid fa-circle-info info-icon" data-tooltip="Level of Training: Frontline, Intermediate, or Advanced. Each tier has different duration & skill depth."></i>
        </div>
        <div class="attribute-content">
          <h4>Level of Training</h4>
          <p>Frontline, Intermediate, or Advanced tiers.</p>
        </div>
      </div>
      <div class="attribute-card">
        <div class="attribute-icon">
          <i class="fa-solid fa-user-tie"></i>
          <i class="fa-solid fa-circle-info info-icon" data-tooltip="Training Model: In-service (ref) for on-the-job learning, or Scholarship-based for full-time study."></i>
        </div>
        <div class="attribute-content">
          <h4>Training Model</h4>
          <p>In-service or Scholarship-based.</p>
        </div>
      </div>
      <div class="attribute-card">
        <div class="attribute-icon">
          <i class="fa-solid fa-hand-holding-dollar"></i>
          <i class="fa-solid fa-circle-info info-icon" data-tooltip="Stipend Amount: $200 (ref), $400, $600, or $800. Helps support trainees financially."></i>
        </div>
        <div class="attribute-content">
          <h4>Stipend Amount</h4>
          <p>$200, $400, $600, or $800.</p>
        </div>
      </div>
      <div class="attribute-card">
        <div class="attribute-icon">
          <i class="fa-solid fa-people-group"></i>
          <i class="fa-solid fa-circle-info info-icon" data-tooltip="Annual Training Capacity: 100, 500 (ref), 1000, 1500, or 2000. Larger capacities scale workforce faster."></i>
        </div>
        <div class="attribute-content">
          <h4>Annual Training Capacity</h4>
          <p>100, 500, 1000, 1500, 2000 trainees.</p>
        </div>
      </div>
      <div class="attribute-card">
        <div class="attribute-icon">
          <i class="fa-solid fa-chalkboard"></i>
          <i class="fa-solid fa-circle-info info-icon" data-tooltip="Delivery Method: Online (ref), In-person, or Hybrid. Chooses how training is delivered."></i>
        </div>
        <div class="attribute-content">
          <h4>Delivery Method</h4>
          <p>Online, In-person, or Hybrid.</p>
        </div>
      </div>
      <div class="attribute-card">
        <div class="attribute-icon">
          <i class="fa-solid fa-building-columns"></i>
          <i class="fa-solid fa-circle-info info-icon" data-tooltip="Number of Training Sites: Multiple State Capitals (ref), Single Hub, Zonal Centers, or Decentralized nodes."></i>
        </div>
        <div class="attribute-content">
          <h4>Number of Training Sites</h4>
          <p>Defines geographical distribution.</p>
        </div>
      </div>
      <div class="attribute-card">
        <div class="attribute-icon">
          <i class="fa-solid fa-file-invoice-dollar"></i>
          <i class="fa-solid fa-circle-info info-icon" data-tooltip="Fee per Completion (USD): The total fee paid by participants upon completing the training."></i>
        </div>
        <div class="attribute-content">
          <h4>Fee per Training Completion</h4>
          <p>Cost charged after training.</p>
        </div>
      </div>
    </div>
  </section>

  <!-- Inputs Tab -->
  <section id="inputsTab" class="tabcontent" tabindex="0">
    <div class="input-card">
      <h2>Configure Programme Options <i class="fa-solid fa-circle-info info-icon-input" data-tooltip="Hover over each label for details."></i></h2>
      <p>Select your options below. All fields are required. <em>(Reference values in parentheses)</em></p>
      <form onsubmit="event.preventDefault();">
        <div class="input-cards">
          <!-- Level of Training -->
          <div class="input-level-card">
            <h3>
              Level of Training<span class="reference">(Ref: Frontline)</span>
              <i class="fa-solid fa-user-graduate info-icon-input" data-tooltip="Choose Frontline (3 months, ref), Intermediate (12 months), or Advanced (24 months)."></i>
            </h3>
            <div class="options">
              <label><input type="radio" name="levelTraining" value="frontline" checked /> Frontline (3 months)</label>
              <label><input type="radio" name="levelTraining" value="intermediate" /> Intermediate (12 months)</label>
              <label><input type="radio" name="levelTraining" value="advanced" /> Advanced (24 months)</label>
            </div>
          </div>
          <!-- Training Model -->
          <div class="input-level-card">
            <h3>
              Training Model<span class="reference">(Ref: In-service)</span>
              <i class="fa-solid fa-user-tie info-icon-input" data-tooltip="In-service if participants work while training or Scholarship-based for full-time study."></i>
            </h3>
            <div class="options">
              <label><input type="radio" name="trainingModel" value="inservice" checked /> In-service Training</label>
              <label><input type="radio" name="trainingModel" value="scholarship" /> Scholarship-based Training</label>
            </div>
          </div>
          <!-- Stipend Amount -->
          <div class="input-level-card">
            <h3>
              Stipend Amount<span class="reference">(Ref: $200)</span>
              <i class="fa-solid fa-hand-holding-dollar info-icon-input" data-tooltip="Stipend: $200 (ref), $400, $600, $800. Helps with living costs."></i>
            </h3>
            <div class="options">
              <label><input type="radio" name="stipendAmount" value="200" checked /> $200</label>
              <label><input type="radio" name="stipendAmount" value="400" /> $400</label>
              <label><input type="radio" name="stipendAmount" value="600" /> $600</label>
              <label><input type="radio" name="stipendAmount" value="800" /> $800</label>
            </div>
          </div>
          <!-- Annual Training Capacity -->
          <div class="input-level-card">
            <h3>
              Annual Training Capacity<span class="reference">(Ref: 500 trainees)</span>
              <i class="fa-solid fa-people-group info-icon-input" data-tooltip="Choose 100, 500 (ref), 1000, 1500, or 2000 participants."></i>
            </h3>
            <div class="options">
              <label><input type="radio" name="annualCapacity" value="100" /> 100 trainees</label>
              <label><input type="radio" name="annualCapacity" value="500" checked /> 500 trainees</label>
              <label><input type="radio" name="annualCapacity" value="1000" /> 1000 trainees</label>
              <label><input type="radio" name="annualCapacity" value="1500" /> 1500 trainees</label>
              <label><input type="radio" name="annualCapacity" value="2000" /> 2000 trainees</label>
            </div>
          </div>
          <!-- Delivery Method -->
          <div class="input-level-card">
            <h3>
              Delivery Method<span class="reference">(Ref: Online)</span>
              <i class="fa-solid fa-laptop info-icon-input" data-tooltip="Online (ref), In-person, or Hybrid. Each affects how training is provided."></i>
            </h3>
            <div class="options">
              <label><input type="radio" name="deliveryMethod" value="online" checked /> Online</label>
              <label><input type="radio" name="deliveryMethod" value="inperson" /> In-person</label>
              <label><input type="radio" name="deliveryMethod" value="hybrid" /> Hybrid</label>
            </div>
          </div>
          <!-- Number of Training Sites -->
          <div class="input-level-card">
            <h3>
              Number of Training Sites<span class="reference">(Ref: Multiple State Capitals)</span>
              <i class="fa-solid fa-map-location-dot info-icon-input" data-tooltip="Multiple State Capitals (ref), Single Hub, Zonal Centers, or Decentralized nodes."></i>
            </h3>
            <div class="options">
              <label><input type="radio" name="trainingSites" value="centralized" /> Single Centralized Hub</label>
              <label><input type="radio" name="trainingSites" value="stateCapitals" checked /> Multiple State Capitals</label>
              <label><input type="radio" name="trainingSites" value="zonalCenters" /> Zonal Regional Centers</label>
              <label><input type="radio" name="trainingSites" value="decentralized" /> Decentralized Rural Nodes</label>
            </div>
          </div>
          <!-- Fee per Training Completion -->
          <div class="input-level-card">
            <h3>
              Fee per Training Completion (USD)
              <i class="fa-solid fa-money-bill-wave info-icon-input" data-tooltip="Slider sets the final fee (USD) upon training completion."></i>
            </h3>
            <div class="options slider-option">
              <label for="costSliderFETP">
                <i class="fa-solid fa-dollar-sign"></i>
                <span id="costLabelFETP">2500</span>
              </label>
              <input type="range" id="costSliderFETP" min="500" max="5000" step="100" value="2500"
                     oninput="updateFETPCostDisplay(this.value)" />
            </div>
          </div>
        </div>
        <div class="buttons-row">
          <button type="button" onclick="openFETPScenario()">Calculate &amp; View Results</button>
        </div>
      </form>
    </div>
  </section>

  <!-- Popup Modal for Results -->
  <div id="resultModal" class="modal">
    <div class="modal-content">
      <span class="close-button" onclick="closeModal()">&times;</span>
      <div id="modalResults"></div>
    </div>
  </div>

  <!-- Adoption Likelihood Tab -->
  <section id="probTab" class="tabcontent" tabindex="0">
    <div class="calculation-info">
      <h4>Adoption Likelihood</h4>
      <p>Click “Show Probability Plot” to view the forecasted decision maker support.</p>
      <div class="buttons-row">
        <button onclick="renderFETPProbChart()">Show Probability Plot</button>
      </div>
      <div class="chart-grid">
        <div class="chart-box" style="height:350px; overflow:hidden;">
          <h3>Adoption Likelihood</h3>
          <canvas id="probChartFETP"></canvas>
        </div>
      </div>
    </div>
  </section>

  <!-- Costs & Benefits Tab -->
  <section id="costsTab" class="tabcontent" tabindex="0">
    <div class="calculation-info">
      <h4>Costs &amp; Benefits Analysis</h4>
      <p>
        This section estimates the total programme cost and monetised benefits.<br />
        <small>
          Benefits = (QALY Gain per Participant × Number of Trainees × $50,000).
          This approximates the economic value of improved health outcomes.
        </small>
      </p>
      <div class="qaly-selector">
        <label for="qalyFETPSelect">Select QALY Gain per Participant:</label>
        <select id="qalyFETPSelect" onchange="renderFETPCostsBenefits()">
          <option value="low">Low (0.01 QALYs)</option>
          <option value="moderate" selected>Moderate (0.05 QALYs)</option>
          <option value="high">High (0.08 QALYs)</option>
        </select>
      </div>
      <div id="costsFETPResults"></div>
      <div class="modelling-assumptions">
        <h3><i class="fa-solid fa-lightbulb"></i> Assumptions</h3>
        <p>
          Cost estimates combine variable costs (participant fee) and fixed costs (venue, materials, trainer fees, etc.).<br>
          A base fixed cost of $35,500 is adjusted by $10 for each trainee above or below 500.
        </p>
      </div>
      <div class="cost-icons">
        <button class="buttons-row" onclick="toggleCostAccordion()">Cost Breakdown</button>
        <button class="buttons-row" onclick="toggleFETPBenefitsAnalysis()">Benefits Explanation</button>
      </div>
      <div id="detailedCostBreakdown" style="display:none;">
        <div class="accordion-item">
          <h3>Direct Costs</h3>
          <div class="accordion-content">
            <ul>
              <li><strong>Training &amp; Development:</strong>
                <ul>
                  <li>Venue rental for workshops & meetings</li>
                  <li>Acquisition of training materials</li>
                  <li>Compensation for trainers & speakers</li>
                  <li>Content dev & licensing fees</li>
                </ul>
              </li>
              <li><strong>Personnel Costs:</strong>
                <ul>
                  <li>Salaries for full-time staff</li>
                  <li>Consultant fees</li>
                  <li>Employment benefits & taxes</li>
                </ul>
              </li>
              <li><strong>Technology Costs:</strong>
                <ul>
                  <li>Hardware procurement</li>
                  <li>Software purchases</li>
                  <li>Maintenance & support</li>
                </ul>
              </li>
              <li><strong>Logistical Costs:</strong>
                <ul>
                  <li>Travel & accommodation expenses</li>
                  <li>Catering services</li>
                </ul>
              </li>
              <li><strong>Miscellaneous Costs:</strong>
                <ul>
                  <li>Printing & stationery</li>
                  <li>Communication expenses</li>
                  <li>Insurance coverage</li>
                </ul>
              </li>
            </ul>
          </div>
        </div>
        <div class="accordion-item">
          <h3>Indirect Costs</h3>
          <div class="accordion-content">
            <ul>
              <li><strong>Opportunity Costs:</strong>
                <ul>
                  <li>Lost productivity from training participation</li>
                  <li>Hiring temps or paying overtime</li>
                </ul>
              </li>
              <li><strong>Infrastructure Costs:</strong>
                <ul>
                  <li>Facility upgrades & modifications</li>
                  <li>Depreciation of used equipment</li>
                </ul>
              </li>
              <li><strong>Administrative Costs:</strong>
                <ul>
                  <li>Office space & utilities</li>
                  <li>Management & oversight time</li>
                </ul>
              </li>
            </ul>
          </div>
        </div>
        <div class="accordion-item">
          <h3>Recurring Costs</h3>
          <div class="accordion-content">
            <ul>
              <li><strong>Maintenance & Upkeep:</strong>
                <ul>
                  <li>Regular updates to training materials</li>
                  <li>Continuous trainer development</li>
                  <li>Renewal fees for software/licenses</li>
                </ul>
              </li>
            </ul>
          </div>
        </div>
      </div>
      <div id="detailedFETPBenefitsAnalysis" class="cost-cards" style="display:none;">
        <div class="cost-card">
          <h4><i class="fa-solid fa-hand-holding-dollar"></i> QALY Benefits</h4>
          <p>
            Benefits = (QALY Gain per Participant × Number of Trainees × $50,000).
            This reflects the economic value of improved health outcomes.
          </p>
        </div>
      </div>
    </div>
  </section>

  <!-- Visualizations Tab -->
  <section id="visualizationsTab" class="tabcontent" tabindex="0">
    <h2>Interactive Visualizations</h2>
    <div class="visualizations-container">
      <div id="mapContainer" class="map-container">
        <p style="font-size:0.9em;color:#555;">
          Below is a sample map displaying hypothetical training site markers. Zoom &amp; pan to explore.
        </p>
      </div>
      <div id="dashboardContainer" class="dashboard-container">
        <div style="text-align:center; margin-bottom:10px; color:#444;">
          <strong>Sample Cost Distribution Chart</strong><br />
          <small>These data are illustrative only.</small>
        </div>
        <canvas id="dashboardChart"></canvas>
      </div>
    </div>
  </section>

  <!-- Scenarios Tab -->
  <section id="scenariosTab" class="tabcontent" tabindex="0">
    <div class="calculation-info">
      <h4>Saved Scenarios</h4>
      <p>
        Each scenario includes your chosen options plus the computed uptake and net benefit.
        Export saved scenarios to PDF for side-by-side comparison.
      </p>
      <div class="buttons-row">
        <button onclick="saveFETPScenario()">Save Current Scenario</button>
        <button onclick="exportFETPComparison()">Compare &amp; Export PDF</button>
      </div>
      <div class="table-container">
        <table id="FETPScenarioTable">
          <thead>
            <tr>
              <th>Name</th>
              <th>Fee (USD)</th>
              <th>Level</th>
              <th>Model</th>
              <th>Stipend</th>
              <th>Capacity</th>
              <th>Delivery</th>
              <th>Sites</th>
              <th>Uptake (%)</th>
              <th>Net Benefit (USD)</th>
            </tr>
          </thead>
          <tbody></tbody>
        </table>
      </div>
    </div>
  </section>

  <footer>
    <p>&copy; 2025 STEPS Decision Aid. All Rights Reserved.<br/>Mesfin Genie, Newcastle Business School, The University of Newcastle, Australia</p>
  </footer>
</div>
<script src="script.js"></script>
</body>
</html>
