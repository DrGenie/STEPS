<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>STEPS - Scalable Training Estimation and Planning System</title>
  <link rel="stylesheet" href="styles.css" />
  <!-- Font Awesome Icons -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
        integrity="sha512-papNMzNnQn5h+1G+FHu8SyuXHs6A1k+Ln7tK5qRo1l5eYm6Jzv+1pArJ7N4C9FfpRrmAgM3tYWd3FZ9jKz1Bw=="
        crossorigin="anonymous" referrerpolicy="no-referrer"/>
  <!-- Chart.js -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <!-- jsPDF -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <!-- Leaflet CSS and JS -->
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
    integrity="sha512-sA+8s4M6Omi0oJmd5dbuap3T7jsSObbd3xd4/fP8HAmVRHNFht6BFB/hxPx9U0z0XnPFADLvF6Roig4SGuOj/A=="
    crossorigin=""/>
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
    integrity="sha512-VV1c7L1lEpByI4A+ZOC88SH0s+hRxbgAjvzuz36eZGwN+I9IMRhMC/jazcK0e+RghWyA4EkO8wgm+0d0JY3h3g=="
    crossorigin=""></script>
</head>
<body>
<div class="container">
  <header>
    <h1>STEPS Decision Aid Tool</h1>
    <p>
      STEPS helps policy makers in India plan and scale Field Epidemiology Training Programs by predicting programme uptake,
      evaluating economic tradeoffs, and comparing key programme features.
    </p>
    <button id="faqBtn" class="faq-btn"><i class="fa-solid fa-question-circle"></i> FAQ</button>
  </header>

  <nav class="tabs" role="tablist">
    <button class="tablink" data-tab="introTab" aria-selected="true">
      <i class="fa-solid fa-info-circle"></i><span> Introduction</span>
    </button>
    <button class="tablink" data-tab="instructionsTab" aria-selected="false">
      <i class="fa-solid fa-circle-question"></i><span> Instructions</span>
    </button>
    <button class="tablink" data-tab="attributesTab" aria-selected="false">
      <i class="fa-solid fa-list"></i><span> Attributes</span>
    </button>
    <button class="tablink" data-tab="inputsTab" aria-selected="false">
      <i class="fa-solid fa-sliders"></i><span> Inputs</span>
    </button>
    <button class="tablink" data-tab="probTab" aria-selected="false">
      <i class="fa-solid fa-chart-pie"></i><span> Program Adoption Likelihood</span>
    </button>
    <button class="tablink" data-tab="costsTab" aria-selected="false">
      <i class="fa-solid fa-calculator"></i><span> Costs &amp; Benefits</span>
    </button>
    <button class="tablink" data-tab="dashboardTab" aria-selected="false">
      <i class="fa-solid fa-tachometer-alt"></i><span> Dashboard</span>
    </button>
    <button class="tablink" data-tab="scenariosTab" aria-selected="false">
      <i class="fa-solid fa-folder-open"></i><span> Saved Scenarios</span>
    </button>
  </nav>

  <!-- Introduction Tab -->
  <section id="introTab" class="tabcontent" tabindex="0" style="display: block;">
    <div class="intro-box">
      <p>
        Field Epidemiology Training Programs (FETP) are essential for strengthening public health responses.
        STEPS uses discrete choice experiment estimates to predict programme uptake ‚Äì the probability that policy makers will endorse your chosen configuration ‚Äì and to assess cost‚Äìbenefit tradeoffs.
      </p>
      <ul>
        <li><strong>Instructions</strong>: A guide to using the tool.</li>
        <li><strong>Attributes</strong>: Overview of key features.</li>
        <li><strong>Inputs</strong>: Configure your options using our streamlined grid‚Äêbased form.</li>
        <li><strong>Program Adoption Likelihood</strong>: View a donut chart showing forecasted support.</li>
        <li><strong>Costs &amp; Benefits</strong>: See a dynamic cost‚Äìbenefit analysis with explanation of how higher predicted uptake drives net benefit.</li>
        <li><strong>Dashboard</strong>: Explore live training program data with real charts and maps that update dynamically.</li>
        <li><strong>Saved Scenarios</strong>: Save, compare, and export configurations individually or as an overall PDF.</li>
      </ul>
    </div>
  </section>

  <!-- Instructions Tab -->
  <section id="instructionsTab" class="tabcontent" tabindex="0">
    <div class="calculation-info instructions">
      <h4>How to Use STEPS</h4>
      <ol>
        <li><strong>Review Attributes:</strong> The Attributes tab explains each key feature using round info icons and illustrative emojis.</li>
        <li><strong>Configure Inputs:</strong> In the Inputs tab, select options from each grouped block. Reference values (in parentheses) guide your choices.</li>
        <li><strong>Program Adoption Likelihood:</strong> See the donut chart forecasting the probability that policy makers endorse your configuration.</li>
        <li><strong>Costs &amp; Benefits:</strong> The analysis shows total cost and monetised benefits. Higher Predicted Uptake implies greater enrollment and thus higher net benefit.</li>
        <li><strong>Dashboard:</strong> Explore live training program data with a Regional Enrollment bar chart and a Training Trend line chart that update dynamically.</li>
        <li><strong>Saved Scenarios:</strong> Save and export individual scenario details or an overall PDF comparison.</li>
      </ol>
    </div>
  </section>

  <!-- Attributes Tab -->
  <section id="attributesTab" class="tabcontent" tabindex="0">
    <h2>Key Attributes</h2>
    <div class="attributes-grid">
      <!-- 1) Level of Training -->
      <div class="attribute-card">
        <div class="attribute-icon">
          <i class="fa-solid fa-user-graduate"></i>
          <i class="fa-solid fa-info-circle info-icon" data-tooltip="Frontlineüìä, Intermediateüìà, AdvancedüöÄ ‚Äì each tier offers increasing training depth."></i>
        </div>
        <div class="attribute-content">
          <h4>Level of Training</h4>
          <p>Frontline, Intermediate, Advanced.</p>
        </div>
      </div>
      <!-- 2) Training Model -->
      <div class="attribute-card">
        <div class="attribute-icon">
          <i class="fa-solid fa-user-tie"></i>
          <i class="fa-solid fa-info-circle info-icon" data-tooltip="In-serviceüßë‚Äçüíª (ref) or Scholarship-basedüéì."></i>
        </div>
        <div class="attribute-content">
          <h4>Training Model</h4>
          <p>In-service or Scholarship-based.</p>
        </div>
      </div>
      <!-- 3) Delivery Method -->
      <div class="attribute-card">
        <div class="attribute-icon">
          <i class="fa-solid fa-chalkboard"></i>
          <i class="fa-solid fa-info-circle info-icon" data-tooltip="In-personüè´, Hybridüíªüè´, Fully Onlineüíª."></i>
        </div>
        <div class="attribute-content">
          <h4>Delivery Method</h4>
          <p>In-person, Hybrid, Fully Online.</p>
        </div>
      </div>
      <!-- 4) Number of Training Sites -->
      <div class="attribute-card">
        <div class="attribute-icon">
          <i class="fa-solid fa-map-location-dot"></i>
          <i class="fa-solid fa-info-circle info-icon" data-tooltip="Single Centralüìç, Multiple State Capitalsüìçüìç, Zonal Regional Centersüìçüìçüìç, Decentralized Sitesüìçüìçüìçüìç."></i>
        </div>
        <div class="attribute-content">
          <h4>Number of Training Sites</h4>
          <p>Single, Multiple, Zonal, Decentralized.</p>
        </div>
      </div>
      <!-- 5) Annual Training Capacity -->
      <div class="attribute-card">
        <div class="attribute-icon">
          <i class="fa-solid fa-people-group"></i>
          <i class="fa-solid fa-info-circle info-icon" data-tooltip="Options: 100, 500 (ref), 1000, 1500, 2000 trainees."></i>
        </div>
        <div class="attribute-content">
          <h4>Annual Training Capacity</h4>
          <p>100‚Äì2000 trainees.</p>
        </div>
      </div>
      <!-- 6) Stipend Amount -->
      <div class="attribute-card">
        <div class="attribute-icon">
          <i class="fa-solid fa-hand-holding-dollar"></i>
          <i class="fa-solid fa-info-circle info-icon" data-tooltip="$200, $400, $600, or $800."></i>
        </div>
        <div class="attribute-content">
          <h4>Stipend Amount</h4>
          <p>$200‚Äì$800.</p>
        </div>
      </div>
      <!-- 7) Fee per Training Completion -->
      <div class="attribute-card">
        <div class="attribute-icon">
          <i class="fa-solid fa-file-invoice-dollar"></i>
          <i class="fa-solid fa-info-circle info-icon" data-tooltip="The fee (USD) charged upon training completion."></i>
        </div>
        <div class="attribute-content">
          <h4>Fee per Completion</h4>
          <p>Adjustable (USD).</p>
        </div>
      </div>
    </div>
  </section>

  <!-- Inputs Tab -->
  <section id="inputsTab" class="tabcontent" tabindex="0">
    <div class="input-card">
      <h2>Configure Programme Options <i class="fa-solid fa-info-circle info-icon-input" data-tooltip="Hover over each icon for details."></i></h2>
      <p>Select your options below. All fields are required. <em>(Reference values in parentheses)</em></p>
      <form onsubmit="event.preventDefault();">
        <div class="inputs-grid">
          <!-- Level of Training -->
          <div class="input-block">
            <label class="input-label">
              Level of Training <span class="reference">(Ref: Frontline)</span>
              <i class="fa-solid fa-info-circle info-icon-input" data-tooltip="Frontlineüìä (3 mo, ref), Intermediateüìà (12 mo), AdvancedüöÄ (24 mo)."></i>
            </label>
            <div class="input-options">
              <label><input type="radio" name="levelTraining" value="frontline" checked /> Frontlineüìä (3 mo)</label>
              <label><input type="radio" name="levelTraining" value="intermediate" /> Intermediateüìà (12 mo)</label>
              <label><input type="radio" name="levelTraining" value="advanced" /> AdvancedüöÄ (24 mo)</label>
            </div>
          </div>
          <!-- Training Model -->
          <div class="input-block">
            <label class="input-label">
              Training Model <span class="reference">(Ref: In-service)</span>
              <i class="fa-solid fa-info-circle info-icon-input" data-tooltip="In-serviceüßë‚Äçüíª (ref) or Scholarship-basedüéì."></i>
            </label>
            <div class="input-options">
              <label><input type="radio" name="trainingModel" value="inservice" checked /> In-serviceüßë‚Äçüíª</label>
              <label><input type="radio" name="trainingModel" value="scholarship" /> Scholarship-basedüéì</label>
            </div>
          </div>
          <!-- Delivery Method -->
          <div class="input-block">
            <label class="input-label">
              Delivery Method <span class="reference">(Ref: Online)</span>
              <i class="fa-solid fa-info-circle info-icon-input" data-tooltip="In-personüè´, Hybridüíªüè´, Fully Onlineüíª."></i>
            </label>
            <div class="input-options">
              <label><input type="radio" name="deliveryMethod" value="inperson" /> In-personüè´</label>
              <label><input type="radio" name="deliveryMethod" value="hybrid" /> Hybridüíªüè´</label>
              <label><input type="radio" name="deliveryMethod" value="online" checked /> Fully Onlineüíª</label>
            </div>
          </div>
          <!-- Number of Training Sites -->
          <div class="input-block">
            <label class="input-label">
              Number of Training Sites <span class="reference">(Ref: Multiple State Capitals)</span>
              <i class="fa-solid fa-info-circle info-icon-input" data-tooltip="Single Centralüìç, State Capitalsüìçüìç, Zonal Regional Centersüìçüìçüìç, Decentralized Local Sitesüìçüìçüìçüìç."></i>
            </label>
            <div class="input-options">
              <label><input type="radio" name="trainingSites" value="centralized" /> Single Central Siteüìç</label>
              <label><input type="radio" name="trainingSites" value="stateCapitals" checked /> Multiple State Capitalsüìçüìç</label>
              <label><input type="radio" name="trainingSites" value="zonalCenters" /> Zonal Regional Centersüìçüìçüìç</label>
              <label><input type="radio" name="trainingSites" value="decentralized" /> Decentralized Local Sitesüìçüìçüìçüìç</label>
            </div>
          </div>
          <!-- Annual Training Capacity -->
          <div class="input-block">
            <label class="input-label">
              Annual Training Capacity <span class="reference">(Ref: 500 trainees)</span>
              <i class="fa-solid fa-info-circle info-icon-input" data-tooltip="Options: 100, 500, 1000, 1500, or 2000 trainees."></i>
            </label>
            <div class="input-options">
              <label><input type="radio" name="annualCapacity" value="100" /> 100 trainees</label>
              <label><input type="radio" name="annualCapacity" value="500" checked /> 500 trainees</label>
              <label><input type="radio" name="annualCapacity" value="1000" /> 1000 trainees</label>
              <label><input type="radio" name="annualCapacity" value="1500" /> 1500 trainees</label>
              <label><input type="radio" name="annualCapacity" value="2000" /> 2000 trainees</label>
            </div>
          </div>
          <!-- Stipend Amount -->
          <div class="input-block">
            <label class="input-label">
              Stipend Amount <span class="reference">(Ref: $200)</span>
              <i class="fa-solid fa-info-circle info-icon-input" data-tooltip="$200‚Äì$800 to offset costs."></i>
            </label>
            <div class="input-options">
              <label><input type="radio" name="stipendAmount" value="200" checked /> $200</label>
              <label><input type="radio" name="stipendAmount" value="400" /> $400</label>
              <label><input type="radio" name="stipendAmount" value="600" /> $600</label>
              <label><input type="radio" name="stipendAmount" value="800" /> $800</label>
            </div>
          </div>
          <!-- Fee per Training Completion -->
          <div class="input-block">
            <label class="input-label">
              Fee per Training Completion (USD)
              <i class="fa-solid fa-info-circle info-icon-input" data-tooltip="Set the fee using the slider."></i>
            </label>
            <div class="input-options slider-option">
              <label for="costSliderFETP">
                <i class="fa-solid fa-dollar-sign"></i>
                <span id="costLabelFETP">2500</span>
              </label>
              <input type="range" id="costSliderFETP" min="0" max="10000" step="100" value="2500"
                     oninput="updateFETPCostDisplay(this.value);" />
            </div>
          </div>
        </div>
        <div class="buttons-row">
          <button type="button" onclick="openFETPScenario()">Calculate &amp; View Results</button>
        </div>
      </form>
    </div>
  </section>

  <!-- Popup Modal for Results -->
  <div id="resultModal" class="modal">
    <div class="modal-content">
      <span class="close-button" onclick="closeModal()">&times;</span>
      <div id="modalResults"></div>
    </div>
  </div>

  <!-- Program Adoption Likelihood Tab -->
  <section id="probTab" class="tabcontent" tabindex="0">
    <div class="calculation-info">
      <h4>Program Adoption Likelihood</h4>
      <p>Click ‚ÄúShow Probability Plot‚Äù to view forecasted support from decision makers.</p>
      <div class="buttons-row">
        <button onclick="renderFETPProbChart()">Show Probability Plot</button>
      </div>
      <div class="chart-grid">
        <div class="chart-box" style="height:350px; overflow:hidden;">
          <h3>Program Adoption Likelihood</h3>
          <canvas id="probChartFETP"></canvas>
        </div>
      </div>
    </div>
  </section>

  <!-- Costs & Benefits Tab -->
  <section id="costsTab" class="tabcontent" tabindex="0">
    <div class="calculation-info">
      <h4>Costs &amp; Benefits Analysis</h4>
      <p>
        This section estimates the total programme cost and monetised benefits.<br/>
        <small>
          Benefits = (QALY Gain per Participant √ó Number of Trainees √ó $50,000). Higher predicted uptake means more enrollment, increasing net benefit.
        </small>
      </p>
      <div class="calculation-info" id="dynamicCostEstimate">
        <h4>Estimated Total Cost</h4>
        <p id="estimatedCostDisplay">Calculate to update cost.</p>
      </div>
      <div class="qaly-selector">
        <label for="qalyFETPSelect">Select QALY Gain per Participant:</label>
        <select id="qalyFETPSelect" onchange="renderFETPCostsBenefits()">
          <option value="low">Low (0.01 QALYs)</option>
          <option value="moderate" selected>Moderate (0.05 QALYs)</option>
          <option value="high">High (0.08 QALYs)</option>
        </select>
      </div>
      <div id="costsFETPResults"></div>
      <div class="modelling-assumptions">
        <h3><i class="fa-solid fa-lightbulb"></i> Assumptions</h3>
        <p>
          Cost estimates combine variable costs (fee per participant √ó capacity) and fixed costs.
          The base fixed cost of $35,500 is adjusted by $10 per trainee (above or below 500) plus extras for in‚Äëperson/hybrid delivery and advanced training.
          Predicted Uptake represents the probability that policy makers endorse your configuration; higher uptake increases enrollment and thus net benefit.
        </p>
      </div>
      <div class="cost-icons">
        <button class="buttons-row" onclick="toggleCostAccordion()">Cost Breakdown</button>
        <button class="buttons-row" onclick="toggleFETPBenefitsAnalysis()">Benefits Explanation</button>
        <button class="buttons-row" onclick="exportIndividualScenario()">Export Selected Scenario</button>
      </div>
      <div id="detailedCostBreakdown" style="display:none;">
        <div class="accordion-item">
          <h3>Direct Costs</h3>
          <div class="accordion-content">
            <ul>
              <li><strong>Training &amp; Development:</strong>
                <ul>
                  <li>Venue rental</li>
                  <li>Training materials</li>
                  <li>Trainer compensation</li>
                  <li>Content development & licensing</li>
                </ul>
              </li>
              <li><strong>Personnel Costs:</strong>
                <ul>
                  <li>Staff salaries</li>
                  <li>Consultant fees</li>
                  <li>Benefits & taxes</li>
                </ul>
              </li>
              <li><strong>Technology Costs:</strong>
                <ul>
                  <li>Hardware procurement</li>
                  <li>Software purchases</li>
                  <li>Maintenance & support</li>
                </ul>
              </li>
              <li><strong>Logistical Costs:</strong>
                <ul>
                  <li>Travel & accommodation</li>
                  <li>Catering services</li>
                </ul>
              </li>
              <li><strong>Miscellaneous:</strong>
                <ul>
                  <li>Printing & stationery</li>
                  <li>Communication expenses</li>
                  <li>Insurance</li>
                </ul>
              </li>
            </ul>
          </div>
        </div>
        <div class="accordion-item">
          <h3>Indirect Costs</h3>
          <div class="accordion-content">
            <ul>
              <li><strong>Opportunity Costs:</strong>
                <ul>
                  <li>Lost productivity</li>
                  <li>Temporary replacements/overtime</li>
                </ul>
              </li>
              <li><strong>Infrastructure:</strong>
                <ul>
                  <li>Facility upgrades</li>
                  <li>Equipment depreciation</li>
                </ul>
              </li>
              <li><strong>Administrative:</strong>
                <ul>
                  <li>Overheads & utilities</li>
                  <li>Management time</li>
                </ul>
              </li>
            </ul>
          </div>
        </div>
        <div class="accordion-item">
          <h3>Recurring Costs</h3>
          <div class="accordion-content">
            <ul>
              <li><strong>Maintenance & Upkeep:</strong>
                <ul>
                  <li>Material updates</li>
                  <li>Trainer development</li>
                  <li>Software/license renewals</li>
                </ul>
              </li>
            </ul>
          </div>
        </div>
      </div>
      <div id="detailedFETPBenefitsAnalysis" class="cost-cards" style="display:none;">
        <div class="cost-card">
          <h4><i class="fa-solid fa-hand-holding-dollar"></i> QALY Benefits</h4>
          <p>
            Benefits = (QALY Gain √ó Trainees √ó $50,000). Higher predicted uptake drives more enrollment, increasing net benefit.
          </p>
        </div>
      </div>
    </div>
  </section>

  <!-- Dashboard Tab -->
  <section id="dashboardTab" class="tabcontent" tabindex="0">
    <h2>Training Program Dashboard</h2>
    <p class="dashboard-description">
      The Dashboard tab displays a Regional Enrollment bar chart and a Training Trend line chart.
      These charts are built using sample data that update dynamically to provide insight into regional performance and monthly trends.
    </p>
    <div class="dashboard-grid">
      <div class="dashboard-chart">
        <h3>Regional Enrollment</h3>
        <canvas id="regionalEnrollmentChart"></canvas>
      </div>
      <div class="dashboard-chart">
        <h3>Training Trend (Last 12 Months)</h3>
        <canvas id="trainingTrendChart"></canvas>
      </div>
    </div>
  </section>

  <!-- Saved Scenarios Tab -->
  <section id="scenariosTab" class="tabcontent" tabindex="0">
    <div class="calculation-info">
      <h4>Saved Scenarios</h4>
      <p>
        Each scenario displays your selected options along with the computed Program Adoption Likelihood and Net Benefit.
        You can export individual scenario details or an overall PDF comparison.
      </p>
      <div class="buttons-row">
        <button onclick="saveFETPScenario()">Save Current Scenario</button>
        <button onclick="exportFETPComparison()">Export Overall PDF</button>
      </div>
      <div class="table-container">
        <table id="FETPScenarioTable">
          <thead>
            <tr>
              <th>Name</th>
              <th>Level</th>
              <th>Model</th>
              <th>Delivery</th>
              <th>Sites</th>
              <th>Capacity</th>
              <th>Stipend</th>
              <th>Fee</th>
              <th>Adoption Likelihood</th>
              <th>Net Benefit (USD)</th>
            </tr>
          </thead>
          <tbody></tbody>
        </table>
      </div>
    </div>
  </section>

  <!-- FAQ Overlay -->
  <div id="faqOverlay" class="faq-overlay">
    <div class="faq-content">
      <span class="close-faq" onclick="toggleFAQ()">&times;</span>
      <h2>Frequently Asked Questions</h2>
      <ul>
        <li><strong>What is Predicted Uptake?</strong>
          <p>It is the forecasted probability that policy makers will endorse your chosen configuration. Higher predicted uptake implies more enrollment, which increases monetised benefits and net benefit.</p>
        </li>
        <li><strong>How is Net Benefit Calculated?</strong>
          <p>Net Benefit = Monetised Benefits ‚Äì Total Training Cost. Benefits are calculated as (QALY Gain per Participant √ó Number of Trainees √ó $50,000).</p>
        </li>
        <li><strong>What do the info icons mean?</strong>
          <p>Each round info icon provides a tooltip explanation with illustrative emojis to help you understand each option.</p>
        </li>
        <li><strong>How is the Dashboard constructed?</strong>
          <p>
            The Dashboard tab displays two charts:
            <ul>
              <li><em>Regional Enrollment:</em> A bar chart showing enrollment data by region.</li>
              <li><em>Training Trend:</em> A line chart showing monthly enrollment trends over the last 12 months.</li>
            </ul>
            In a real deployment, these charts would pull live data from training program systems.
          </p>
        </li>
      </ul>
    </div>
  </div>

  <footer>
    <p>&copy; 2025 STEPS Decision Aid. All Rights Reserved.<br/>Mesfin Genie, Newcastle Business School, The University of Newcastle, Australia</p>
  </footer>
</div>
<script src="script.js"></script>
</body>
</html>
